X-Git-Url: http://git.videolan.org/?p=ffmpeg.git;a=blobdiff_plain;f=libavdevice%2Fv4l2.c;h=2808e13ac3fa143a41f8a56877aaffc82344a0b5;hp=4829b1b694902235b4c06308a4e0dda7aa0dc52c;hb=fd58678b86023ea98665f06756bf03f91e56be54;hpb=b040ffc84c5e35436590e0bcea6608a2ad31cf84

diff --git a/libavdevice/v4l2.c b/libavdevice/v4l2.c
index 4829b1b..2808e13 100644
--- a/libavdevice/v4l2.c
+++ b/libavdevice/v4l2.c
@@ -156,9 +156,6 @@ static int device_open(AVFormatContext *ctx)
 {
     struct v4l2_capability cap;
     int fd;
-#if CONFIG_LIBV4L2
-    int fd_libv4l;
-#endif
     int res, err;
     int flags = O_RDWR;
 
@@ -175,16 +172,6 @@ static int device_open(AVFormatContext *ctx)
 
         return AVERROR(err);
     }
-#if CONFIG_LIBV4L2
-    fd_libv4l = v4l2_fd_open(fd, 0);
-    if (fd < 0) {
-        err = AVERROR(errno);
-        av_log(ctx, AV_LOG_ERROR, "Cannot open video device with libv4l neither %s : %s\n",
-               ctx->filename, strerror(errno));
-        return err;
-    }
-    fd = fd_libv4l;
-#endif
 
     res = v4l2_ioctl(fd, VIDIOC_QUERYCAP, &cap);
     if (res < 0) {
